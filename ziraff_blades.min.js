!function(){"use strict";var e=angular.module("ziraff_blades",[]);function a(n,i,r,o){return n.remoteAPI=n.remoteAPI||app_configuration.app_config.api_services.analytics,{load_blade_sets:function(){var e=o.id||o.Id||null,a=null;a="client_accounts"===r.current.data.permissionKey&&"leads"==o.isFrom?"client_leads":r.current.data.permissionKey;return i.get(n.remoteAPI+"api/blade/getbladetypes?permissionKey="+a+"&&id="+e)},load_bldes_data:function(e,a){var t=null;t="client_accounts"===r.current.data.permissionKey&&"leads"==o.isFrom?"client_leads":r.current.data.permissionKey;var l={CompanyId:n.rootId,ModuleDetailId:window.sessionStorage.getItem("ModuleDetailId"),PermissionKey:t,Role:"null",Id:o.id||o.Id||"null",BladeType:e,FilterType:a||"null"};return i.post(n.remoteAPI+"api/blade/GetBladeDetails",l)}}}e.factory("bldesService",a),a.$inject=["ziraffBladesConfiguration","$http","$state","$stateParams"],e.value("ziraffBladesConfiguration",{rootId:null,role:null,userName:null,remoteAPI:null})}();
!function(){function t(i,o){return{restrict:"E",scope:{configuration:"="},template:'<div id="zBladesRenderer"></div>',link:function(e,t,a){e.$on("load_analytics",function(){$("#zBladesRenderer").empty(),i.load_blade_sets().then(function(t){e.bladeSets=t.data,$("#zBladesRenderer").append(o('<div ng-repeat="bladeset in bladeSets track by $index"><blade-renderer blade-type="bladeset"></blade-renderer></div>')(e))})})},controller:"ziraffBCtrl"}}function e(t,e){}function a(r,s){return{restrict:"E",template:'<div ng-show="!isLoading" id="renderer_{{bladeType}}"></div><div ng-if="isLoading"><img src="https://i.gifer.com/6px6.gif"></div>',scope:{bladeType:"="},link:function(a,t,e){a.isLoading=!0;var i=["HCColumnDrillDown","HCPie","HCColumn","HCLine","HCBasicColumn","HCBasicColumnDrillDown","HCStackedColumn","HCStackedColumnDrillDown","HCDualAxisGraph","HCDualAxisDrillDownChart"],o={HCColumnDrillDown:function(t,e){Highcharts.setOptions({colors:e.Data.Colors,lang:{thousandsSep:",",drillUpText:"◁ Back To"}}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent"},lang:{thousandsSep:","},title:{text:null},credits:{enabled:!1},xAxis:{className:"highcharts-color-0",type:"category",title:{text:e.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:e.Data.YTitle},gridLineWidth:0},legend:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{color:"black",enabled:!0,format:"{point.y:,.0f}"}}},tooltip:{formatter:function(){function t(e,t){var a=e.point.series.options.data.filter(function(t){return e.key==t[0]});return"tooltip"==t?a[0][2]:0}var e=this.point;return e.drilldown?0==this.point.tooltip||null==this.point.tooltip?'<span style="color:{point.color}">'+e.name+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+e.name+":#"+this.point.tooltip+"</span>-$"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):0==t(this,"tooltip")||null==t(this,"tooltip")?'<span style="color:{point.color}">'+e.name+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+e.name+":#"+t(this,"tooltip")+"-$"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},series:[{colorByPoint:!0,data:e.Data.Data.MainData}],drilldown:{drillUpButton:{relativeTo:"spacingBox",position:{y:-6,x:-20},verticalAlign:"top",theme:{fill:"#D3D3D3","stroke-width":1,stroke:"silver",r:0,states:{hover:{fill:"#C0C0C0"}}}},series:e.Data.Data.SubData}})},HCPie:function(t,e){Highcharts.chart(t,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie",backgroundColor:"transparent"},title:{text:null},yAxis:{gridLineWidth:0},tooltip:{formatter:function(){var t=this.point;return'<span style="color:{point.color}">'+t.name+"</span>: <b>"+t.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</b><br/>"}},credits:{enabled:!1},plotOptions:{pie:{size:200,allowPointSelect:!0,dataLabels:{enabled:!0},showInLegend:!0}},series:[{colorByPoint:!0,data:e.Data}]})},HCColumn:function(t,e){Highcharts.setOptions({lang:{thousandsSep:","},colors:e.Data.Colors}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent"},lang:{thousandsSep:","},title:{text:null},xAxis:{className:"highcharts-color-0",type:"category",title:{text:e.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:e.Data.YTitle},gridLineWidth:0},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:,.0f}"}}},tooltip:{formatter:function(){var t=this.point;return 0==t.tooltip?'<span style="color:{point.color}">'+t.name+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+t.name+":#"+this.point.tooltip+"</span>-$"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},series:[{colorByPoint:!0,data:e.Data.Data.MainData}]})},HCLine:function(t,e){Highcharts.setOptions({colors:e.Data.Colors}),Highcharts.chart(t,{chart:{type:"line",backgroundColor:"transparent"},title:{text:null},xAxis:{className:"highcharts-color-0",categories:e.Data.Data.Categories,title:{text:e.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:e.Data.YTitle},gridLineWidth:0},legend:{enabled:!1},credits:{enabled:!1},tooltip:{formatter:function(){var t=this.point;return 0==this.point.ToolTip||null==this.point.ToolTip?'<span style="color:{point.color}">'+this.x+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+this.x+"</span>: <b>#"+this.point.ToolTip+"</b> - $"+t.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},series:e.Data.Data.Data})},HCBasicColumn:function(t,e){Highcharts.setOptions({colors:e.Data.Colors}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent"},title:{text:null},credits:{enabled:!1},xAxis:{className:"highcharts-color-0",type:"category",title:{text:e.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:e.Data.YTitle},gridLineWidth:0},legend:{enabled:!0},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y}"}}},tooltip:{formatter:function(){return'<span style="color:{point.color}">'+this.point.name+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},series:e.Data.Data.MainData})},HCBasicColumnDrillDown:function(){},HCStackedColumn:function(t,e){Highcharts.setOptions({lang:{drillUpText:"◁ Back To",thousandsSep:","},colors:e.Data.Colors}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent"},title:{text:null},xAxis:{className:"highcharts-color-0",type:"category",title:{text:e.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:e.Data.YTitle},gridLineWidth:0},legend:{enabled:!0},credits:{enabled:!1},tooltip:{formatter:function(){return'<span style="color:{point.color}">'+this.point.name+":"+this.point.y+":"+this.point.tooltip1+"</span>-$"+this.point.tooltip2.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},plotOptions:{column:{stacking:"normal"},series:{borderWidth:0,dataLabels:{enabled:!1,style:{textShadow:!1,fontSize:"1vw"},format:"{point.y:,.0f}"}}},series:e.Data.Data.MainData})},HCStackedColumnDrillDown:function(t,r){Highcharts.setOptions({lang:{drillUpText:"◁ Back To",thousandsSep:","},colors:r.Data.Colors}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent",events:{drilldown:function(t){if(!t.seriesOptions){var e=r.Data.Data.drilldown,a=r.Data.Data.drilldown2,i=r.Data.Data.drilldown3,o=e[t.point.name],l=a[t.point.name],n=i[t.point.name];this.addSingleSeriesAsDrilldown(t.point,o),this.addSingleSeriesAsDrilldown(t.point,l),this.addSingleSeriesAsDrilldown(t.point,n),this.applyDrilldown()}}}},title:{text:null},xAxis:{className:"highcharts-color-0",type:"category",title:{text:r.Data.XTitle}},yAxis:{className:"highcharts-color-0",title:{text:r.Data.YTitle},gridLineWidth:0},legend:{enabled:!0},tooltip:{formatter:function(){function t(e,t){var a=e.point.series.options.data.filter(function(t){return e.key==t[0]});return("tooltip1"==t?a[0][2]:a[0][3]).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"<br/>"}var e=this.point;return e.drilldown?'<span style="color:{point.color}">'+e.name+":"+this.point.y+":"+this.point.tooltip1+"</span>-$"+this.point.tooltip2.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+e.name+":"+this.point.y+":"+t(this,"tooltip1")+"-$"+t(this,"tooltip2")}},credits:{enabled:!1},plotOptions:{column:{stacking:"normal"},series:{borderWidth:0,dataLabels:{enabled:!1,style:{textShadow:!1,"font-weight":"bold",fontSize:"0.9vw",color:"#003399",fill:"#003399",stroke:"#003399"},format:"{point.y:,.0f}"}}},series:r.Data.Data.MainData,drilldown:{series:[]}})},HCDualAxisGraph:function(t,e){Highcharts.setOptions({lang:{thousandsSep:","}}),Highcharts.chart(t,{chart:{type:"column"},title:{text:null},credits:{enabled:!1},xAxis:{type:"category",labels:{formatter:function(){return this.value.toString()},style:{color:null}}},rangeSelector:{selected:1},yAxis:[{labels:{formatter:function(){return 1e6<=this.value?this.value/1e6+"M":this.value/1e3+"K"},style:{color:"black"}},title:{text:null}},{title:{text:null},labels:{format:"{value}",style:{color:"black"}},opposite:!0}],tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span>',pointFormat:'<br/><span style="color:{series.color};padding:0">{series.name}: </span><span style="padding:0"><b>{point.y:,.2f}</b></span>',shared:!0,useHTML:!0},plotOptions:{series:{borderWidth:0,dataLabels:{color:"black",enabled:!0,formatter:function(){return"Value"==this.series.name||1e3<=this.y.toFixed(0)?this.y.toFixed(0)/1e3+"K":"Value"==this.series.name||1e6<=this.y.toFixed(0)?this.y.toFixed(0)/1e6+"M":this.y.toFixed(0)}}}},series:e.Data.Data.DualAxisMainData})},HCDualAxisDrillDownChart:function(t,l){Highcharts.setOptions({lang:{thousandsSep:",",drillUpText:"◁ Back To"}}),Highcharts.chart(t,{chart:{type:"column",events:{drilldown:function(t){if(!t.seriesOptions){var e=l.Data.Data.drilldown,a=l.Data.Data.drilldown2,i=e[t.point.drilldown],o=a[t.point.drilldown];this.addSingleSeriesAsDrilldown(t.point,i),this.addSingleSeriesAsDrilldown(t.point,o),this.applyDrilldown()}}}},title:{text:null},credits:{enabled:!1},xAxis:{type:"category",labels:{formatter:function(){return this.value.toString()}}},rangeSelector:{selected:1},yAxis:[{labels:{formatter:function(){return 1e6<=this.value?this.value/1e6+"M":this.value/1e3+"K"},style:{color:"black"}},title:{text:null}},{title:{text:null},labels:{format:"{value}",style:{color:"black"}},opposite:!0}],tooltip:{headerFormat:'<span style="font-size:10px;color:black;">{point.key}</span>',pointFormat:'<br/><span style="color:{series.color};padding:0">{series.name}: </span><span style="padding:0"><b>{point.y:,.2f}</b></span>',shared:!0,useHTML:!0},plotOptions:{series:{borderWidth:0,dataLabels:{color:"black",borderColor:"black",enabled:!0,formatter:function(){return"Value"==this.series.name&&1e3<=this.y.toFixed(0)?(Highcharts.numberFormat(this.y.toFixed(0)/1e3,2)+"K").replace(/\B(?=(\d{3})+(?!\d))/g,","):"Value"==this.series.name&&1e6<=this.y.toFixed(0)?(Highcharts.numberFormat(this.y.toFixed(0)/1e3,2)+"M").replace(/\B(?=(\d{3})+(?!\d))/g,","):this.y.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}}},series:l.Data.Data.DualAxisMainData,drilldown:{drillUpButton:{relativeTo:"spacingBox",position:{y:-6,x:-20},verticalAlign:"top",theme:{fill:"#D3D3D3","stroke-width":1,stroke:"silver",r:0,states:{hover:{fill:"#C0C0C0"}}}},series:[]}})}},l=["KPIwithColumnChart","KPIwithPieChart","KPIwithDualAxisChart"],n={KPIwithPieChart:function(t,e){Highcharts.setOptions({colors:["#fd625e","#f2c80f","#F27B21","#B887AD","#8CC641","#BE4A47","#3CB64B","#34C6BB","#26AAE1"]}),Highcharts.chart(t,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie",backgroundColor:"transparent"},title:{text:null},yAxis:{gridLineWidth:0},tooltip:{pointFormat:"Value:<b>{point.y}</b>"},credits:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",size:"50%",dataLabels:{enabled:!0,format:"<b>{point.name}</b>: {point.percentage:.1f}%",style:{color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"},connectorColor:"silver"}}},series:[{colorByPoint:!0,data:e.Data}]})},KPIwithColumnChart:function(t,e){Highcharts.setOptions({lang:{thousandsSep:","}}),Highcharts.chart(t,{chart:{type:"column",backgroundColor:"transparent"},lang:{thousandsSep:","},title:{text:null},xAxis:{type:"category",title:{text:null}},yAxis:{title:{text:null}},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{borderWidth:0,dataLabels:{enabled:!0,format:"{point.y:,.0f}"}}},tooltip:{formatter:function(){var t=this.point;return 0==t.tooltip?'<span style="color:{point.color}">'+t.name+"</span>:"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):'<span style="color:{point.color}">'+t.name+":#"+this.point.tooltip+"</span>-$"+this.point.y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}},series:[{colorByPoint:!0,data:e.Data.MainData}]})},KPIwithDualAxisChart:function(t,e){Highcharts.setOptions({lang:{thousandsSep:",",drillUpText:"◁ Back To"}}),Highcharts.chart(t,{chart:{type:"column"},title:{text:null},credits:{enabled:!1},xAxis:{type:"category",labels:{formatter:function(){return this.value.toString()}}},rangeSelector:{selected:1},yAxis:[{labels:{formatter:function(){return 1e6<=this.value?this.value/1e6+"M":this.value/1e3+"K"},style:{color:"black"}},title:{text:null}},{title:{text:null},labels:{format:"{value}",style:{color:"black"}},opposite:!0}],tooltip:{headerFormat:'<span style="font-size:10px">{point.key}</span>',pointFormat:'<br/><span style="color:{series.color};padding:0">{series.name}: </span><span style="padding:0"><b>{point.y:,.2f}</b></span>',shared:!0,useHTML:!0},plotOptions:{series:{borderWidth:0,dataLabels:{color:"black",enabled:!0,formatter:function(){return"Value"==this.series.name||1e3<=this.y.toFixed(0)?this.y.toFixed(0)/1e3+"K":"Value"==this.series.name||1e6<=this.y.toFixed(0)?this.y.toFixed(0)/1e6+"M":this.y.toFixed(0)}}}},series:e.Data.DualAxisMainData,drilldown:{drillUpButton:{relativeTo:"spacingBox",position:{y:-6,x:-20},verticalAlign:"top",theme:{fill:"#D3D3D3","stroke-width":1,stroke:"silver",r:0,states:{hover:{fill:"#C0C0C0"}}}},series:[]}})}};r.load_bldes_data(a.bladeType).then(function(t){for(var e=0;e<t.data.Blades.length;e++)$("#renderer_"+a.bladeType).append(s(t.data.Blades[e].Heading)(a)),-1<i.indexOf(t.data.Blades[e].BladeTypeName)?o[t.data.Blades[e].BladeTypeName](a.bladeType+e,t.data.Blades[e]):-1<l.indexOf(t.data.Blades[e].BladeTypeName)&&n[t.data.Blades[e].BladeTypeName](a.bladeType+e,t.data.Blades[e]);a.isLoading=!1}),a.onFilterChange=function(t,e){a.isLoading=!0,r.load_bldes_data(e,t).then(function(t){for(var e=0;e<t.data.Blades.length;e++)-1<i.indexOf(t.data.Blades[e].BladeTypeName)?o[t.data.Blades[e].BladeTypeName](a.bladeType+e,t.data.Blades[e]):-1<l.indexOf(t.data.Blades[e].BladeTypeName)&&n[t.data.Blades[e].BladeTypeName](a.bladeType+e,t.data.Blades[e]);a.isLoading=!1})}},controller:["$scope",function(t){}]}}angular.module("ziraff_blades").directive("ziraffBlades",t).controller("ziraffBCtrl",e).directive("bladeRenderer",a),t.$inject=["bldesService","$compile"],e.$inject=["$scope","bldesService","$compile"],a.$inject=["bldesService","$compile"]}();
